
"""
https://huggingface.co/spaces/HuggingFaceFW/blogpost-fineweb-v1
https://huggingface.co/datasets/HuggingFaceFW/fineweb
https://huggingface.co/papers/2306.01116
https://arxiv.org/abs/2306.01116

"... Recently, we released üç∑ FineWeb, a new, large-scale (15-trillion tokens, 44TB disk space) dataset for LLM pretraining. FineWeb is derived from 96 CommonCrawl snapshots and produces better-performing LLMs than other open pretraining datasets.

"""

# % pip install datatrove
from datatrove.pipeline.readers import ParquetReader

# limit determines how many documents will be streamed (remove for all)
# to fetch a specific dump: hf://datasets/HuggingFaceFW/fineweb/data/CC-MAIN-2024-10
# replace "data" with "sample/100BT" to use the 100BT sample

# data_file = 'data/CC-MAIN-2024-10'
# data_file = 'sample/100BT'
# data_reader = ParquetReader("hf://datasets/HuggingFaceFW/fineweb/" + data_file, limit=3) 

data_reader = ParquetReader("hf://datasets/HuggingFaceFW/fineweb/data", limit=3) 
for document in data_reader():
    # do something with document
    print("\n",document)

"""
2024-06-17 18:36:41.067 | INFO     | datatrove.pipeline.readers.base:read_files_shard:193 - Reading input file CC-MAIN-2013-20/000_00000.parquet

 Document(text="How AP reported in all formats from tornado-stricken regionsMarch 8, 2012\nWhen the first serious bout of tornadoes of 2012 blew through middle America in the middle of the night, they touched down in places hours from any AP bureau. Our closest video journalist was Chicago-based Robert Ray, who dropped his plans to travel to Georgia for Super Tuesday, booked several flights to the cities closest to the strikes and headed for the airport. He‚Äôd decide once there which flight to take.\nHe never got on board a plane. Instead, he ended up driving toward Harrisburg, Ill., where initial reports suggested a town was destroyed. That decision turned out to be a lucky break for the AP. Twice.\nRay was among the first journalists to arrive and he confirmed those reports -- in all formats. He shot powerful video, put victims on the phone with AP Radio and played back sound to an editor who transcribed the interviews and put the material on text wires. He then walked around the devastation with the Central Regional Desk on the line, talking to victims with the phone held so close that editors could transcribe his interviews in real time.\nRay also made a dramatic image of a young girl who found a man‚Äôs prosthetic leg in the rubble, propped it up next to her destroyed home and spray-painted an impromptu sign: ‚ÄúFound leg. Seriously.‚Äù\nThe following day, he was back on the road and headed for Georgia and a Super Tuesday date with Newt Gingrich‚Äôs campaign. The drive would take him through a stretch of the South that forecasters expected would suffer another wave of tornadoes.\nTo prevent running into THAT storm, Ray used his iPhone to monitor Doppler radar, zooming in on extreme cells and using Google maps to direct himself to safe routes. And then the journalist took over again.\n‚ÄúWhen weather like that occurs, a reporter must seize the opportunity to get the news out and allow people to see, hear and read the power of nature so that they can take proper shelter,‚Äù Ray says.\nSo Ray now started to use his phone to follow the storms. He attached a small GoPro camera to his steering wheel in case a tornado dropped down in front of the car somewhere, and took video of heavy rain and hail with his iPhone. Soon, he spotted a tornado and the chase was on. He followed an unmarked emergency vehicle to Cleveland, Tenn., where he was first on the scene of the storm's aftermath.\nAgain, the tornadoes had struck in locations that were hours from the nearest AP bureau. Damage and debris, as well as a wickedly violent storm that made travel dangerous, slowed our efforts to get to the news. That wasn‚Äôt a problem in Tennessee, where our customers were well served by an all-formats report that included this text story.\n‚ÄúCLEVELAND, Tenn. (AP) _ Fierce wind, hail and rain lashed Tennessee for the second time in three days, and at least 15 people were hospitalized Friday in the Chattanooga area.‚Äù\nThe byline? Robert Ray.\nFor being adept with technology, chasing after news as it literally dropped from the sky and setting a standard for all-formats reporting that put the AP ahead on the most competitive news story of the day, Ray wins this week‚Äôs $300 Best of the States prize.\n¬© 2013 The Associated Press. All rights reserved. Terms and conditions apply. See AP.org for details.", id='<urn:uuid:d66bc6fe-8477-4adf-b430-f6a558ccc8ff>', media=[], metadata={'dump': 'CC-MAIN-2013-20', 'url': 'http://%20jwashington@ap.org/Content/Press-Release/2012/How-AP-reported-in-all-formats-from-tornado-stricken-regions', 'date': '2013-05-18T05:48:54Z', 'file_path': 's3://commoncrawl/crawl-data/CC-MAIN-2013-20/segments/1368696381249/warc/CC-MAIN-20130516092621-00000-ip-10-60-113-184.ec2.internal.warc.gz', 'language': 'en', 'language_score': 0.9721424579620361, 'token_count': 717})

 Document(text='Did you know you have two little yellow, nine-volt-battery-sized adrenal glands in your body, just chilling out, maxin‚Äô, relaxin‚Äô all cool on top of your kidneys? Someone told me this and I checked it out. Turns out it‚Äôs true.\nIt seems as though your adrenal glands are kind of like those British Royal Guards with the big, black fuzzy hats who stand like statues in front of Buckingham Palace. They just stand there quietly, not doing much really, just enjoying the brown, slippery beach that is your kidneys.\nHowever, if anything startling should happen that requires your attention ‚Äî like say you‚Äôre about to give a speech at a wedding or your hear a twig crack outside your tent or your doorbell rings in the middle of the night ‚Äî then they leap into action, jumping out of their peaceful slumber to squeeze out a big dose of adrenaline right into your body, pumping you up, and turning you into a primal, warrior-like version of yourself.\nWhen tension runs high and adrenaline is secreted into your body some crazy things can happen ‚Äî sometimes called the fight-or-flight response:\n- Your heart rate increases. And specifically, your body starts sending blood to all your big muscles and diverts it away from ‚Äúnon-critical‚Äù parts of your body, like your brain, immune system, and digestive system. I guess someone figured you could digest the sandwich after you killed the bear.\n- Your pupils dilate and you get tunnel vision. Quite literally, adrenaline also reduces your peripheral vision, which together with your big, wide pupils helps you focus on what lies ahead. You can‚Äôt quite see through walls, but if a crow is diving at your eyes you might be able to swat it away better.\n- Your body gets ready to boot it. In addition to the rising heart rate, your body starts turning lots more stuff into sugar, raising your blood sugar level and filling you with energy. You might not even feel pain as easily, so the raspberry bushes that shred your legs when you‚Äôre running out of the forest won‚Äôt slow you down.\nBut what‚Äôs also great about adrenalin is that, first of all, you don‚Äôt have to control it. It just sort of kicks it into high gear when it figures you could use a boost. I think it‚Äôs kind of cool knowing that your body will help you out when you need it most. Punch me in the face and suddenly my internal British Royal Guard tosses away his fuzzy, black cap, cracks his neck, and rolls up his sleeves.\nAnd really, isn‚Äôt it that little dose of adrenalin that helps you do a better job when you need it most? It‚Äôs a natural upper, helping you nail the big speech, ace the final exam, or perhaps flee both of those scenes.\nThere‚Äôs a reason some people become adrenaline junkies. The boost you get from your adrenal glands waking up and getting out of bed is intoxicating. Sure, it fuzzes up your thinking a bit and sends your intestines on sabbatical, but it sure does pump you up. And remember: when something important in your life is about to happen, you can count on your good pal adrenaline to be there, juicing you up, helping you fight the good fight.\nJian Ghomeshi is the host of my favorite radio show. It‚Äôs called Q and broadcasts across North America every morning. Jian is a big friend and fan of 1000 Awesome Things and The Book of Awesome and I‚Äôm really excited because he just released his first book. It‚Äôs called 1982 and is a beautifully written memoir about growing up in the suburbs of Toronto and trying to fit in. (My kind of book!) For those of you who love reading, I think he‚Äôs a fantastic writer and am really excited to recommend this book.', id='<urn:uuid:803e14c3-dc2e-43d6-b75d-6fb3981c4fe6>', media=[], metadata={'dump': 'CC-MAIN-2013-20', 'url': 'http://1000awesomethings.com/2012/09/24/934-adrenaline/', 'date': '2013-05-18T08:11:45Z', 'file_path': 's3://commoncrawl/crawl-data/CC-MAIN-2013-20/segments/1368696381249/warc/CC-MAIN-20130516092621-00000-ip-10-60-113-184.ec2.internal.warc.gz', 'language': 'en', 'language_score': 0.9479914307594299, 'token_count': 821})

 Document(text='Car Wash For Clara!\nNow is your chance to help! 2 year old Clara Woodward has Cancer! Clara can‚Äôt say ‚ÄúNeuroblastoma‚Äù but she knows how it feels. You can help!!\nA Car Wash will be held Saturday July 23, 11am-2pm at Java Jet on the corner of Edison & Canal Drive in Kennewick.\nThere is also an account set up in Clara‚Äôs name. Her family lives in Pasco and is travelling to Spokane for treatment.\nFor further information contact‚Äù Kelly Gammon at 509-380-2321', id='<urn:uuid:ac1bbfff-9519-4967-9c64-3dc3a4b471ec>', media=[], metadata={'dump': 'CC-MAIN-2013-20', 'url': 'http://1027kord.com/car-wash-for-clara/', 'date': '2013-05-18T06:49:55Z', 'file_path': 's3://commoncrawl/crawl-data/CC-MAIN-2013-20/segments/1368696381249/warc/CC-MAIN-20130516092621-00000-ip-10-60-113-184.ec2.internal.warc.gz', 'language': 'en', 'language_score': 0.9115182757377625, 'token_count': 125})

 """
